# 1) 将 /images/* 文章图片就近复制并更新引用
pnpm migrate:images || exit 1

# 将迁移后的变更加入暂存，确保本次提交包含更新
git add -A

# 2) 校验图片路径与命名（不合规则阻止提交）
pnpm lint:images || exit 1

# 3) 运行 Vitest，确保配置校验通过
pnpm test || exit 1

# 4) 检查 pnpm 版本和 lockfile 一致性（警告但不阻止提交）
pnpm check:pnpm-version || true
pnpm check:lockfile || true

# 5) 其余按 lint-staged 处理（如 Prettier）
pnpm exec lint-staged
